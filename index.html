<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fraction Master Class</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet"/>
    <style>
        :root {
            --c-green: #4CAF50;
            --c-green-light: #e8f5e9;
            --c-blue: #2196F3;
            --c-blue-light: #e3f2fd;
            --c-gold: #FFC107; 
            --c-gold-light: #fff8e1;
            --c-red: #ef5350; 
            
            --bg-body: #f0f4f8;
            --bg-card: #ffffff;
            --text-main: #37474f;
            --text-muted: #78909c;
            --border: #cfd8dc;
        }

        * { margin:0; padding:0; box-sizing:border-box; }
        
        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg-body);
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-bottom: 60px;
        }

        .header {
            width: 100%;
            background: white;
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid var(--border);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }
        .header h1 {
            font-family: 'Fredoka', sans-serif;
            color: var(--text-main);
            letter-spacing: 0.5px;
            font-size: 1.5rem;
        }

        .main-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            background: #dfe6e9;
            padding: 6px;
            border-radius: 50px;
        }
        .nav-tab {
            background: transparent;
            border: none;
            color: var(--text-muted);
            padding: 10px 25px;
            font-family: 'Fredoka', sans-serif;
            font-size: 1rem;
            cursor: pointer;
            border-radius: 40px;
            transition: all 0.2s;
            font-weight: 600;
        }
        .nav-tab.active {
            background: white;
            color: var(--c-green);
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
        }

        .tool-section {
            display: none;
            width: 100%;
            max-width: 950px;
            flex-direction: column;
            align-items: center;
            animation: fadeIn 0.3s ease;
            padding: 0 15px;
        }
        .tool-section.active { display: flex; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        .dashboard {
            background: var(--bg-card);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.05);
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            border: 1px solid white;
        }

        .btn {
            padding: 8px 20px; border-radius: 30px; font-family: 'Fredoka', sans-serif; font-weight: 600;
            cursor: pointer; border: none; transition: all 0.2s; font-size: 0.95rem;
            display: inline-flex; align-items: center; justify-content: center; gap: 8px;
        }
        .btn-blue { background: var(--c-blue); color: white; }

        /* Fraction Bars Styling */
        .fb-toolbar {
            display: flex; align-items: center; justify-content: space-between;
            flex-wrap: wrap; gap: 15px; width: 100%;
            background: #1f2937; color: white; padding: 12px 20px; border-radius: 12px;
            margin-bottom: 15px;
        }
        .fb-total-display {
            background: #374151; padding: 6px 15px; border-radius: 8px;
            font-weight: bold; font-family: monospace; font-size: 1.1rem; border: 1px solid #4b5563;
        }
        .fb-work-area { width: 100%; max-width: 950px; min-height: 250px; max-height: 55vh; overflow-y: auto; padding: 15px 0; }
        .fb-bars-wrapper { display: flex; flex-direction: column; gap: 15px; width: 100%; }
        
        /* The Row Layout */
        .fb-row { display: flex; align-items: center; gap: 15px; }
        
        /* 1/X Identity Label */
        .fb-row-label { width: 50px; text-align: right; font-size: 0.9rem; font-weight: 700; color: var(--text-muted); flex-shrink: 0; }
        
        /* X/Y Current Value Badge */
        .fb-value-badge {
            width: 70px; height: 35px; background: #eceff1; border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
            font-family: 'Fredoka', sans-serif; font-weight: 700; font-size: 1.1rem;
            color: var(--text-main); border: 1px solid var(--border);
            flex-shrink: 0; transition: all 0.2s;
        }
        .fb-row.has-selection .fb-value-badge { background: var(--c-gold-light); border-color: var(--c-gold); color: #856404; }

        .fb-bar { flex: 1; height: 55px; display: flex; border: 2px solid #111827; border-radius: 6px; overflow: hidden; background: #eee; }
        .fb-seg { flex: 1; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 12px; color: #111827; border-right: 1px solid rgba(0,0,0,0.15); cursor: pointer; background-color: var(--fb-base); }
        .fb-seg.fb-selected { background-color: var(--fb-highlight) !important; box-shadow: inset 0 0 0 2px rgba(255,255,255,0.4); }
        
        .fb-controls-panel { width: 100%; max-width: 950px; margin-top: 15px; background: white; border-radius: 12px; padding: 20px; border: 1px solid #eceff1; display: flex; flex-direction: column; gap: 15px; align-items: center; }
        .fb-preset-row { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; align-items: center; }
        .fb-preset-btn { background: #f3f4f6; color: #374151; border: 1px solid #d1d5db; padding: 8px 16px; border-radius: 8px; font-family: 'Fredoka', sans-serif; font-weight: 600; font-size: 0.95rem; cursor: pointer; }
        .fb-custom-input { width: 90px; padding: 10px; border: 2px solid var(--c-blue); border-radius: 10px; font-family: 'Fredoka', sans-serif; font-size: 1.2rem; text-align: center; }
        .fb-clear-btn { background: var(--c-red); color: white; border: none; padding: 8px 18px; border-radius: 8px; font-family: 'Fredoka', sans-serif; font-weight: 600; cursor: pointer; }

        .sync-toggle { display: flex; align-items: center; gap: 10px; cursor: pointer; user-select: none; }
        .sync-toggle input { transform: scale(1.4); cursor: pointer; }
        .sync-label { font-family: 'Fredoka', sans-serif; font-weight: 600; font-size: 0.95rem; color: #9ca3af; }

    </style>
</head>
<body>

    <div class="header">
        <h1>Fraction Master Class</h1>
    </div>

    <div class="main-nav">
        <button class="nav-tab active" onclick="switchTab('tab-bars')">Fraction Bars</button>
        <button class="nav-tab" onclick="switchTab('tab-fractions')">Fraction Lab</button>
        <button class="nav-tab" onclick="switchTab('tab-lcd')">LCD Finder</button>
        <button class="nav-tab" onclick="switchTab('tab-simplify')">Simplify</button>
    </div>

    <div id="tab-bars" class="tool-section active">
        <div class="fb-toolbar">
            <label class="sync-toggle">
                <input type="checkbox" id="fb-sync-equivalents">
                <span class="sync-label">Sync Equivalent Fractions</span>
            </label>
            <div class="fb-total-display" id="fb-total-display">Total: 0</div>
            <button class="fb-clear-btn" onclick="fb_reset()">Clear All</button>
        </div>

        <div class="dashboard" style="padding:15px;">
            <div class="fb-work-area" id="fb-work-area">
                <div class="fb-bars-wrapper" id="fb-bars-wrapper"></div>
            </div>
        </div>

        <div class="fb-controls-panel">
            <div class="fb-preset-row" style="background: #f8fafc; padding: 20px; border-radius: 12px; border: 1px dashed var(--border); width: 100%;">
                <div style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
                    <label style="font-family: 'Fredoka', sans-serif; font-weight: 700; font-size: 0.9rem; color: var(--c-blue); text-transform: uppercase;">Custom Denominator (1-100)</label>
                    <div style="display: flex; gap: 15px; align-items: center;">
                        <input type="range" id="fb-slider" min="1" max="100" value="8" 
                               style="width: 250px; accent-color: var(--c-blue);"
                               oninput="syncFBInput(this.value)">
                        <input type="number" id="fb-custom-input" class="fb-custom-input" 
                               value="8" min="1" max="100"
                               oninput="syncFBSlider(this.value)"
                               onkeydown="if(event.key==='Enter') fb_addCustom()">
                        <button class="btn btn-blue" onclick="fb_addCustom()" style="height: 48px; padding: 0 25px;">
                            Add 1/<span id="fb-preview-val">8</span> Bar
                        </button>
                    </div>
                </div>
            </div>

            <div class="fb-preset-row">
                <span style="font-size: 0.85rem; font-weight: 800; color: var(--text-muted); margin-right: 10px;">PRESETS:</span>
                <button class="fb-preset-btn" onclick="fb_addBar(1)">1/1</button>
                <button class="fb-preset-btn" onclick="fb_addBar(2)">1/2</button>
                <button class="fb-preset-btn" onclick="fb_addBar(4)">1/4</button>
                <button class="fb-preset-btn" onclick="fb_addBar(8)">1/8</button>
                <button class="fb-preset-btn" onclick="fb_addBar(16)">1/16</button>
                <button class="fb-preset-btn" onclick="fb_addBar(32)">1/32</button>
                <button class="fb-preset-btn" onclick="fb_addBar(48)">1/48</button>
            </div>
        </div>
    </div>

    <div id="tab-fractions" class="tool-section"><div class="dashboard"><p>Build and compare fractions.</p></div></div>
    <div id="tab-lcd" class="tool-section"><div class="dashboard"><p>LCD Finder logic.</p></div></div>
    <div id="tab-simplify" class="tool-section"><div class="dashboard"><p>Simplify logic.</p></div></div>

<script>
    function switchTab(tabId) {
        document.querySelectorAll('.tool-section').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.nav-tab').forEach(el => el.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        const tabMap = {'tab-bars':0, 'tab-fractions':1, 'tab-lcd':2, 'tab-simplify':3};
        document.querySelectorAll('.nav-tab')[tabMap[tabId]].classList.add('active');
    }

    let fb_bars = [];
    const syncCheckbox = document.getElementById('fb-sync-equivalents');

    function syncFBInput(val) {
        document.getElementById('fb-custom-input').value = val;
        document.getElementById('fb-preview-val').innerText = val;
    }
    function syncFBSlider(val) {
        document.getElementById('fb-slider').value = val;
        document.getElementById('fb-preview-val').innerText = val;
    }

    function fb_addBar(denom) {
        const id = Date.now() + Math.random();
        const hue = (denom * 137.5) % 360;
        const bar = { id, denom, base: `hsl(${hue}, 65%, 55%)`, hl: `hsl(${hue}, 85%, 80%)` };
        fb_bars.push(bar);
        fb_render();
    }

    function fb_addCustom() {
        const val = parseInt(document.getElementById('fb-custom-input').value);
        if(val > 0 && val <= 100) fb_addBar(val);
    }

    function fb_render() {
        const wrapper = document.getElementById('fb-bars-wrapper');
        wrapper.innerHTML = '';
        fb_bars.sort((a,b) => a.denom - b.denom).forEach(bar => {
            const row = document.createElement('div');
            row.className = 'fb-row';
            row.dataset.denom = bar.denom;
            row.dataset.id = bar.id;
            
            // Labels and badges
            row.innerHTML = `
                <div class="fb-row-label">${bar.denom === 1 ? '1' : '1/'+bar.denom}</div>
                <div class="fb-value-badge" id="val-${bar.id}">0/${bar.denom}</div>
            `;
            
            const barEl = document.createElement('div');
            barEl.className = 'fb-bar';
            for(let i=0; i<bar.denom; i++) {
                const seg = document.createElement('div');
                seg.className = 'fb-seg';
                seg.style.backgroundColor = bar.base;
                seg.style.setProperty('--fb-highlight', bar.hl);
                seg.onclick = () => handleSegClick(bar.id, i);
                barEl.appendChild(seg);
            }
            row.appendChild(barEl);
            wrapper.appendChild(row);
        });
        fb_calcTotal();
    }

    function handleSegClick(barId, segIndex) {
        const isSync = syncCheckbox.checked;
        const barObj = fb_bars.find(b => b.id === barId);
        const row = document.querySelector(`.fb-row[data-id="${barId}"]`);
        const segs = row.querySelectorAll('.fb-seg');
        
        const isSelected = segs[segIndex].classList.contains('fb-selected');
        const targetFillRatio = isSelected ? (segIndex / barObj.denom) : ((segIndex + 1) / barObj.denom);

        if (isSync) {
            fb_bars.forEach(b => {
                const bRow = document.querySelector(`.fb-row[data-id="${b.id}"]`);
                const bSegs = bRow.querySelectorAll('.fb-seg');
                const segmentsToHighlight = Math.round(targetFillRatio * b.denom);
                
                bSegs.forEach((s, idx) => {
                    if (idx < segmentsToHighlight) s.classList.add('fb-selected');
                    else s.classList.remove('fb-selected');
                });
                updateRowBadge(b.id, segmentsToHighlight, b.denom);
            });
        } else {
            segs.forEach((s, idx) => {
                if (isSelected) {
                    if (idx >= segIndex) s.classList.remove('fb-selected');
                } else {
                    if (idx <= segIndex) s.classList.add('fb-selected');
                }
            });
            const count = row.querySelectorAll('.fb-seg.fb-selected').length;
            updateRowBadge(barId, count, barObj.denom);
        }
        fb_calcTotal();
    }

    function updateRowBadge(id, count, denom) {
        const badge = document.getElementById(`val-${id}`);
        const row = document.querySelector(`.fb-row[data-id="${id}"]`);
        if (badge) {
            badge.innerText = `${count}/${denom}`;
            if (count > 0) row.classList.add('has-selection');
            else row.classList.remove('has-selection');
        }
    }

    function fb_calcTotal() {
        let total = 0;
        document.querySelectorAll('.fb-row').forEach(row => {
            const denom = parseInt(row.dataset.denom);
            const selected = row.querySelectorAll('.fb-seg.fb-selected').length;
            total += (selected / denom);
        });
        document.getElementById('fb-total-display').innerText = `Total: ${Math.round(total * 1000) / 1000}`;
    }

    function fb_reset() { fb_bars = []; fb_render(); }

    window.onload = () => { fb_addBar(1); fb_addBar(2); fb_addBar(8); };
</script>
</body>
</html>
