<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fraction Master Class</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet"/>
    <style>
        :root {
            --c-green: #4CAF50;
            --c-green-light: #e8f5e9;
            --c-blue: #2196F3;
            --c-blue-light: #e3f2fd;
            --c-gold: #FFC107; 
            --c-gold-light: #fff8e1;
            --c-red: #ef5350; 
            
            --bg-body: #f0f4f8;
            --bg-card: #ffffff;
            --text-main: #37474f;
            --text-muted: #78909c;
            --border: #cfd8dc;
        }

        * { margin:0; padding:0; box-sizing:border-box; }
        
        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg-body);
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-bottom: 60px;
        }

        .header {
            width: 100%;
            background: white;
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid var(--border);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }
        .header h1 {
            font-family: 'Fredoka', sans-serif;
            color: var(--text-main);
            letter-spacing: 0.5px;
            font-size: 1.5rem;
        }

        .main-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            background: #dfe6e9;
            padding: 6px;
            border-radius: 50px;
        }
        .nav-tab {
            background: transparent;
            border: none;
            color: var(--text-muted);
            padding: 10px 25px;
            font-family: 'Fredoka', sans-serif;
            font-size: 1rem;
            cursor: pointer;
            border-radius: 40px;
            transition: all 0.2s;
            font-weight: 600;
        }
        .nav-tab.active {
            background: white;
            color: var(--c-green);
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
        }
        .nav-tab:hover:not(.active) { color: var(--text-main); background: rgba(255,255,255,0.5); }

        .tool-section {
            display: none;
            width: 100%;
            max-width: 900px;
            flex-direction: column;
            align-items: center;
            animation: fadeIn 0.3s ease;
            padding: 0 15px;
        }
        .tool-section.active { display: flex; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        .dashboard {
            background: var(--bg-card);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.05);
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            border: 1px solid white;
        }

        .controls-row {
            display: flex;
            gap: 20px;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            width: 100%;
        }

        .switch-container {
            display: flex;
            align-items: center;
            gap: 10px;
            background: #eceff1;
            padding: 8px 16px;
            border-radius: 30px;
            cursor: pointer;
            user-select: none;
        }
        .switch-label { font-family: 'Fredoka', sans-serif; font-weight: 600; font-size: 0.9rem; color: var(--text-muted); }
        .toggle-switch {
            position: relative; width: 44px; height: 24px;
            background: #b0bec5; border-radius: 20px; transition: 0.3s;
        }
        .toggle-switch::after {
            content: ''; position: absolute; top: 2px; left: 2px;
            width: 20px; height: 20px; background: white; border-radius: 50%;
            transition: 0.3s; box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .switch-container.active .toggle-switch { background: var(--c-gold); }
        .switch-container.active .toggle-switch::after { transform: translateX(20px); }

        .equation-wrapper {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 10px;
        }
        .frac-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 90px;
            position: relative;
            padding: 10px;
            border-radius: 12px;
            border: 2px solid transparent;
        }
        .frac-group.focus-green { background: var(--c-green-light); border-color: var(--c-green); }
        .frac-group.focus-blue { background: var(--c-blue-light); border-color: var(--c-blue); }

        .frac-input {
            width: 100%;
            font-family: 'Fredoka', sans-serif;
            font-size: 2.2rem;
            text-align: center;
            background: white;
            border: 2px solid #eceff1;
            color: var(--text-main);
            border-radius: 8px;
            padding: 5px 0;
        }
        .frac-input:focus { outline: none; border-color: var(--text-muted); }

        .input-green { color: var(--c-green); }
        .input-blue { color: var(--c-blue); }
        .frac-bar { width: 100%; height: 4px; background: var(--text-main); margin: 8px 0; border-radius: 2px; }
        .operator { font-size: 3rem; color: var(--text-muted); font-family: 'Fredoka', sans-serif; margin: 0 10px; }

        .res-container { min-width: 90px; display: flex; flex-direction: column; align-items: center; }
        .res-text { font-family: 'Fredoka', sans-serif; font-size: 2.5rem; font-weight: bold; color: var(--text-main); }

        .simplified-badge {
            font-family: 'Fredoka', sans-serif;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--c-gold);
            background: var(--c-gold-light);
            border: 1px solid var(--c-gold);
            border-radius: 20px;
            padding: 3px 12px;
            margin-top: 6px;
            display: none;
        }

        .btn {
            padding: 8px 20px; border-radius: 30px; font-family: 'Fredoka', sans-serif; font-weight: 600;
            cursor: pointer; border: none; transition: all 0.2s; font-size: 0.95rem;
            display: inline-flex; align-items: center; justify-content: center; gap: 8px;
        }
        .btn:hover:not(:disabled) { transform: translateY(-2px); }
        .btn-outline { background: white; border: 2px solid var(--border); color: var(--text-muted); }
        .btn-green { background: var(--c-green); color: white; }
        .btn-blue { background: var(--c-blue); color: white; }
        .btn-gold { background: var(--c-gold); color: #3e2723; }

        .vis-container { width: 100%; display: flex; flex-direction: column; gap: 20px; }
        .vis-card {
            background: var(--bg-card); border-radius: 16px; padding: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.02);
            display: flex; flex-direction: column; align-items: center;
            border: 1px solid #eceff1;
        }
        .vis-label {
            font-family: 'Fredoka', sans-serif; text-transform: uppercase; letter-spacing: 1.5px;
            font-size: 0.8rem; font-weight: 700; color: var(--text-muted); margin-bottom: 20px;
        }

        svg { overflow: visible; }
        .shape-stroke { stroke: var(--text-main); stroke-width: 2px; }
        .fill-empty { fill: white; }
        .fill-green { fill: var(--c-green); }
        .fill-blue { fill: var(--c-blue); }
        .sub-line { stroke: var(--c-gold); stroke-width: 2px; stroke-dasharray: 4 3; opacity: 0; transition: opacity 0.5s; }
        .show-common .sub-line { opacity: 1; }

        .chart-container { overflow-x: auto; max-width: 100%; padding: 10px; }
        .mult-chart { border-collapse: separate; border-spacing: 3px; margin: 0 auto; }
        .mult-chart td, .mult-chart th {
            width: 42px; height: 42px; text-align: center;
            font-family: 'Fredoka', sans-serif; font-size: 14px;
            border-radius: 6px; cursor: pointer; transition: all 0.2s;
        }
        .col-header { background: #eceff1; color: var(--text-muted); font-weight: bold; }
        .data-cell { background: white; color: var(--text-muted); border: 1px solid #f0f0f0; }
        .lcd-match { background: var(--c-gold); color: #3e2723; font-weight: 800; transform: scale(1.2); z-index: 10; }

        /* Fraction Bars Styling */
        .fb-toolbar {
            display: flex; align-items: center; justify-content: space-between;
            flex-wrap: wrap; gap: 10px; width: 100%;
            background: #1f2937; color: white; padding: 10px 16px; border-radius: 12px;
            margin-bottom: 15px;
        }
        .fb-total-display {
            background: #374151; padding: 4px 12px; border-radius: 6px;
            font-weight: bold; font-family: monospace; font-size: 1.1rem;
        }
        .fb-work-area { width: 100%; max-width: 900px; min-height: 200px; max-height: 55vh; overflow-y: auto; padding: 15px 0; }
        .fb-bars-wrapper { display: flex; flex-direction: column; gap: 10px; width: 100%; }
        .fb-row { display: flex; align-items: center; gap: 10px; }
        .fb-row-label { width: 50px; text-align: right; font-size: 0.9rem; font-weight: 600; color: var(--text-muted); flex-shrink: 0; }
        .fb-bar { flex: 1; height: 50px; display: flex; border: 2px solid #111827; border-radius: 4px; overflow: hidden; }
        .fb-seg { flex: 1; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 14px; color: #111827; border-right: 2px solid #111827; cursor: pointer; background-color: var(--fb-base); }
        .fb-seg.fb-selected { background-color: var(--fb-highlight) !important; box-shadow: inset 0 0 0 3px rgba(255,255,255,0.35); }
        
        .fb-controls-panel { width: 100%; max-width: 900px; margin-top: 15px; background: white; border-radius: 12px; padding: 20px; border: 1px solid #eceff1; display: flex; flex-direction: column; gap: 15px; align-items: center; }
        .fb-preset-row { display: flex; flex-wrap: wrap; gap: 6px; justify-content: center; align-items: center; }
        .fb-preset-btn { background: #f3f4f6; color: #374151; border: 1px solid #d1d5db; padding: 7px 14px; border-radius: 6px; font-family: 'Fredoka', sans-serif; font-weight: 600; font-size: 0.9rem; cursor: pointer; }
        .fb-custom-input { width: 80px; padding: 8px; border: 2px solid var(--c-blue); border-radius: 8px; font-family: 'Fredoka', sans-serif; font-size: 1.1rem; text-align: center; }
        .fb-clear-btn { background: var(--c-red); color: white; border: none; padding: 6px 14px; border-radius: 6px; font-family: 'Fredoka', sans-serif; font-weight: 600; cursor: pointer; }

    </style>
</head>
<body>

    <div class="header">
        <h1>Fraction Master Class</h1>
    </div>

    <div class="main-nav">
        <button class="nav-tab active" onclick="switchTab('tab-fractions')">Fraction Lab</button>
        <button class="nav-tab" onclick="switchTab('tab-lcd')">LCD Finder</button>
        <button class="nav-tab" onclick="switchTab('tab-simplify')">Simplify</button>
        <button class="nav-tab" onclick="switchTab('tab-bars')">Fraction Bars</button>
    </div>

    <div id="tab-fractions" class="tool-section active">
        <div class="dashboard">
            <div class="controls-row">
                <div style="display:flex; gap:10px;">
                    <button id="btn-paint-a" class="btn btn-green" onclick="setPaintMode('a')">Paint Green</button>
                    <button id="btn-paint-b" class="btn btn-outline" onclick="setPaintMode('b')">Paint Blue</button>
                </div>
                <div class="switch-container" id="mode-toggle" onclick="toggleUnlikeMode()">
                    <span class="switch-label">Different Denominators</span>
                    <div class="toggle-switch"></div>
                </div>
            </div>
            <div class="equation-wrapper">
                <div class="frac-group focus-green" id="grp-1">
                    <input type="number" id="n1" class="frac-input input-green" value="1" min="0" oninput="updateLab()">
                    <div class="frac-bar"></div>
                    <input type="number" id="d1" class="frac-input" value="4" min="1" max="100" oninput="handleDenomChange(1, this.value)">
                </div>
                <div class="operator">+</div>
                <div class="frac-group" id="grp-2">
                    <input type="number" id="n2" class="frac-input input-blue" value="1" min="0" oninput="updateLab()">
                    <div class="frac-bar"></div>
                    <input type="number" id="d2" class="frac-input" value="4" min="1" max="100" oninput="handleDenomChange(2, this.value)" disabled>
                </div>
                <div class="operator">=</div>
                <div class="res-container">
                    <span id="rn" class="res-text">2</span>
                    <div class="frac-bar" style="width:100%;"></div>
                    <span id="rd" class="res-text">4</span>
                    <div id="simplified-badge" class="simplified-badge"></div>
                </div>
            </div>
        </div>
        <div class="vis-container">
            <div class="vis-card">
                <div class="vis-label">Bar Model</div>
                <div id="vis-bars" style="width:100%;"></div>
            </div>
        </div>
    </div>

    <div id="tab-lcd" class="tool-section">
        <div class="dashboard">
            <p style="font-family:'Fredoka';">Select two numbers from the top row to find the Lowest Common Denominator.</p>
        </div>
        <div class="chart-container">
            <table class="mult-chart" id="lcd-table"></table>
        </div>
    </div>

    <div id="tab-simplify" class="tool-section">
        <div class="dashboard">
            <div style="display:flex; align-items:center; gap:20px;">
                <div class="frac-group">
                    <input type="number" id="simp-n" class="frac-input" value="6" oninput="simp_update()">
                    <div class="frac-bar"></div>
                    <input type="number" id="simp-d" class="frac-input" value="8" oninput="simp_update()">
                </div>
                <div class="operator">→</div>
                <div class="res-container">
                    <span id="simp-rn" class="res-text">3</span>
                    <div class="frac-bar" style="width:100%;"></div>
                    <span id="simp-rd" class="res-text">4</span>
                </div>
            </div>
        </div>
    </div>

    <div id="tab-bars" class="tool-section">
        <div class="fb-toolbar">
            <div class="fb-total-display" id="fb-total-display">Total: 0</div>
            <button class="fb-clear-btn" onclick="fb_reset()">Clear All</button>
        </div>

        <div class="dashboard" style="padding:15px;">
            <div class="fb-work-area" id="fb-work-area">
                <div class="fb-bars-wrapper" id="fb-bars-wrapper"></div>
            </div>
        </div>

        <div class="fb-controls-panel">
            <div class="fb-preset-row" style="background: #f8fafc; padding: 20px; border-radius: 12px; border: 1px dashed var(--border); width: 100%;">
                <div style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
                    <label style="font-family: 'Fredoka', sans-serif; font-weight: 600; font-size: 0.9rem; color: var(--c-blue);">CUSTOM DENOMINATOR (1-100)</label>
                    <div style="display: flex; gap: 15px; align-items: center;">
                        <input type="range" id="fb-slider" min="1" max="100" value="8" 
                               style="width: 250px; accent-color: var(--c-blue);"
                               oninput="syncFBInput(this.value)">
                        <input type="number" id="fb-custom-input" class="fb-custom-input" 
                               value="8" min="1" max="100"
                               oninput="syncFBSlider(this.value)"
                               onkeydown="if(event.key==='Enter') fb_addCustom()">
                        <button class="btn btn-blue" onclick="fb_addCustom()" style="height: 45px; padding: 0 25px;">
                            Add 1/<span id="fb-preview-val">8</span> Bar
                        </button>
                    </div>
                </div>
            </div>

            <div class="fb-preset-row">
                <span style="font-size: 0.8rem; font-weight: bold; color: var(--text-muted); margin-right: 10px;">COMMON PRESETS:</span>
                <button class="fb-preset-btn" onclick="fb_addBar(2)">1/2</button>
                <button class="fb-preset-btn" onclick="fb_addBar(3)">1/3</button>
                <button class="fb-preset-btn" onclick="fb_addBar(4)">1/4</button>
                <button class="fb-preset-btn" onclick="fb_addBar(5)">1/5</button>
                <button class="fb-preset-btn" onclick="fb_addBar(6)">1/6</button>
                <button class="fb-preset-btn" onclick="fb_addBar(10)">1/10</button>
                <button class="fb-preset-btn" onclick="fb_addBar(12)">1/12</button>
            </div>
        </div>
    </div>

<script>
    // --- GLOBAL NAV ---
    function switchTab(tabId) {
        document.querySelectorAll('.tool-section').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.nav-tab').forEach(el => el.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        const tabMap = {'tab-fractions':0, 'tab-lcd':1, 'tab-simplify':2, 'tab-bars':3};
        document.querySelectorAll('.nav-tab')[tabMap[tabId]].classList.add('active');
    }

    // --- FRACTION LAB LOGIC ---
    let state = { n1: 1, d1: 4, n2: 1, d2: 4, paintMode: 'a', unlikeMode: false };
    function updateLab() {
        state.n1 = parseInt(document.getElementById('n1').value) || 0;
        state.n2 = parseInt(document.getElementById('n2').value) || 0;
        const cd = lcm(state.d1, state.d2);
        const resN = (state.n1 * (cd/state.d1)) + (state.n2 * (cd/state.d2));
        document.getElementById('rn').innerText = resN;
        document.getElementById('rd').innerText = cd;
        renderBars();
    }
    function toggleUnlikeMode() {
        state.unlikeMode = !state.unlikeMode;
        document.getElementById('mode-toggle').classList.toggle('active');
        document.getElementById('d2').disabled = !state.unlikeMode;
        if(!state.unlikeMode) { state.d2 = state.d1; document.getElementById('d2').value = state.d1; }
        updateLab();
    }
    function handleDenomChange(id, val) {
        if(id===1) { state.d1 = parseInt(val) || 1; if(!state.unlikeMode) { state.d2 = state.d1; document.getElementById('d2').value = val; }}
        else state.d2 = parseInt(val) || 1;
        updateLab();
    }
    function renderBars() {
        const container = document.getElementById('vis-bars');
        container.innerHTML = '';
        const draw = (n, d, cls) => {
            const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
            svg.setAttribute("width", "100%"); svg.setAttribute("height", "60");
            for(let i=0; i<d; i++) {
                const rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
                rect.setAttribute("x", (i*(100/d)) + "%"); rect.setAttribute("y", "10");
                rect.setAttribute("width", (100/d) + "%"); rect.setAttribute("height", "40");
                rect.setAttribute("stroke", "#333"); rect.setAttribute("fill", i < n ? (cls==='a'?'#4CAF50':'#2196F3') : 'white');
                svg.appendChild(rect);
            }
            container.appendChild(svg);
        };
        draw(state.n1, state.d1, 'a'); draw(state.n2, state.d2, 'b');
    }

    // --- LCD FINDER LOGIC ---
    function initLCD() {
        const table = document.getElementById('lcd-table');
        let html = '<tr><th>×</th>';
        for(let i=1; i<=12; i++) html += `<th class="col-header" onclick="lcd_select(${i})">${i}</th>`;
        html += '</tr>';
        for(let r=1; r<=12; r++) {
            html += `<tr><td style="background:#eee; font-weight:bold;">${r}</td>`;
            for(let c=1; c<=12; c++) html += `<td class="data-cell" id="lcd-${r}-${c}">${r*c}</td>`;
            html += '</tr>';
        }
        table.innerHTML = html;
    }
    let lcdA = null;
    function lcd_select(n) {
        document.querySelectorAll('.data-cell').forEach(e => e.classList.remove('lcd-match'));
        if(!lcdA) lcdA = n;
        else {
            const match = lcm(lcdA, n);
            document.querySelectorAll('.data-cell').forEach(e => { if(parseInt(e.innerText) === match) e.classList.add('lcd-match'); });
            lcdA = null;
        }
    }

    // --- SIMPLIFY LOGIC ---
    function simp_update() {
        const n = parseInt(document.getElementById('simp-n').value) || 0;
        const d = parseInt(document.getElementById('simp-d').value) || 1;
        const common = gcd(n, d);
        document.getElementById('simp-rn').innerText = n / common;
        document.getElementById('simp-rd').innerText = d / common;
    }

    // --- FRACTION BARS LOGIC ---
    let fb_bars = [];
    function syncFBInput(val) {
        document.getElementById('fb-custom-input').value = val;
        document.getElementById('fb-preview-val').innerText = val;
    }
    function syncFBSlider(val) {
        document.getElementById('fb-slider').value = val;
        document.getElementById('fb-preview-val').innerText = val;
    }
    function fb_addBar(denom) {
        const id = Date.now();
        const hue = (denom * 137.5) % 360;
        const bar = { id, denom, base: `hsl(${hue}, 70%, 50%)`, hl: `hsl(${hue}, 90%, 80%)` };
        fb_bars.push(bar);
        fb_render();
    }
    function fb_addCustom() {
        const val = parseInt(document.getElementById('fb-custom-input').value);
        if(val > 0 && val <= 100) fb_addBar(val);
    }
    function fb_render() {
        const wrapper = document.getElementById('fb-bars-wrapper');
        wrapper.innerHTML = '';
        fb_bars.sort((a,b) => a.denom - b.denom).forEach(bar => {
            const row = document.createElement('div');
            row.className = 'fb-row';
            row.innerHTML = `<div class="fb-row-label">1/${bar.denom}</div>`;
            const barEl = document.createElement('div');
            barEl.className = 'fb-bar';
            for(let i=0; i<bar.denom; i++) {
                const seg = document.createElement('div');
                seg.className = 'fb-seg';
                seg.style.backgroundColor = bar.base;
                seg.style.setProperty('--fb-highlight', bar.hl);
                seg.onclick = () => { seg.classList.toggle('fb-selected'); fb_calcTotal(); };
                barEl.appendChild(seg);
            }
            row.appendChild(barEl);
            wrapper.appendChild(row);
        });
    }
    function fb_calcTotal() {
        let total = 0;
        document.querySelectorAll('.fb-row').forEach(row => {
            const denom = parseInt(row.querySelector('.fb-row-label').innerText.split('/')[1]);
            const selected = row.querySelectorAll('.fb-seg.fb-selected').length;
            total += (selected / denom);
        });
        document.getElementById('fb-total-display').innerText = `Total: ${total.toFixed(3)}`;
    }
    function fb_reset() { fb_bars = []; fb_render(); document.getElementById('fb-total-display').innerText = 'Total: 0'; }

    // --- MATH HELPERS ---
    const gcd = (a, b) => b === 0 ? a : gcd(b, a % b);
    const lcm = (a, b) => (a * b) / gcd(a, b);

    // INIT
    window.onload = () => { initLCD(); updateLab(); fb_addBar(1); };
</script>
</body>
</html>
